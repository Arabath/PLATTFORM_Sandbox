{"remainingRequest":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\src\\components\\Login.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\src\\components\\Login.vue","mtime":1666174950125},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\css-loader\\dist\\cjs.js","mtime":1666176539778},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1666176545428},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\postcss-loader\\src\\index.js","mtime":1666176541485},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1666176543703},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666176538733},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-loader\\lib\\index.js","mtime":1666176542441}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouaW1nTG9naW4gew0KICB3aWR0aDogNjBweDsNCiAgaGVpZ2h0OiBhdXRvOw0KfQ0K"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqOA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-layout align-center justify-center>\r\n    <v-flex xs12 sm8 md6 lg5 xl4>\r\n      <v-card :loading=\"isLoadingLogin\" class=\"mx-auto\" max-width=\"100%\" style=\"opacity: 0.9\">\r\n\r\n        <v-card-text style='padding-left:50px; padding-right:65px; padding-top:0px'>\r\n          <v-form>\r\n            <v-icon dark>mdi-key-variant</v-icon>\r\n\r\n            <v-toolbar-title style='padding-left:20px; padding-bottom:0px; text-align:center'>\r\n              <img class=\"d-inline-block align-top imgLogin\" src=\"../assets/logo_p01.png\" style=\"cursor:pointer\" />\r\n            </v-toolbar-title>\r\n\r\n            <v-toolbar-title style='padding-left:20px; padding-bottom:40px; text-align:center' v-if=\"formulario==0\">\r\n              Bienvenidos a PLATTFORM</v-toolbar-title>\r\n            <v-toolbar-title style='padding-left:20px; padding-bottom:40px; text-align:center' v-if=\"formulario==1\">\r\n              Recuperar Contraseña</v-toolbar-title>\r\n\r\n            <v-text-field v-if=\"formulario!=2\" v-model=\"usuario\" prepend-icon=\"mdi-account\" autofocus color=\"accent\"\r\n              :label=\"labelMail\" @blur=\"listarInstitucionesXPersona()\"></v-text-field>\r\n\r\n            <v-alert border=\"left\" colored-border color=\"green\" elevation=\"1\" v-if=\"formulario==1\">\r\n              <span class=\"textoGray\">Te enviaremos un correo a tu casilla con un enlace para restablecer tu\r\n                contraseña.</span>\r\n            </v-alert>\r\n\r\n            <v-text-field v-if=\"formulario==0\" v-model=\"password\" prepend-icon=\"lock\" type=\"password\" color=\"accent\"\r\n              label=\"Contraseña\" @keyup.enter=\"ingresar()\"></v-text-field>\r\n\r\n            <v-text-field v-if=\"formulario==2\" v-model=\"password_nueva_1\" prepend-icon=\"lock\" type=\"password\"\r\n              color=\"accent\" label=\"Nueva Contraseña \" @keyup.enter=\"ingresar()\"></v-text-field>\r\n\r\n            <v-text-field v-if=\"formulario==2\" v-model=\"password_nueva_2\" prepend-icon=\"lock\" type=\"password\"\r\n              color=\"accent\" label=\"Retipear nueva contraseña \" @keyup.enter=\"ingresar()\"></v-text-field>\r\n\r\n            <v-autocomplete label=\"Institucion\" :items=\"personaInstituciones\" v-model=\"identificador\" solo\r\n              prepend-icon=\"school\" item-text=\"institucion\" item-value=\"identificador\" autocomplete=\"off\">\r\n              <template v-slot:item=\"data\">\r\n                <template>\r\n                  <v-list-item-avatar>\r\n                    <img :src=\"getImgUrl(data.item.logo)\" />\r\n                  </v-list-item-avatar>\r\n                  <v-list-item-content>\r\n                    <v-list-item-title v-text=\"data.item.institucion\"></v-list-item-title>\r\n                  </v-list-item-content>\r\n                </template>\r\n              </template>\r\n            </v-autocomplete>\r\n\r\n            <v-flex class=\"red--text\" v-if=\"error\">{{error}}</v-flex>\r\n            <div class=\"red--text\" v-for=\"v in validaMensaje\" :key=\"v\" v-text=\"v\"></div>\r\n          </v-form>\r\n          <v-row>\r\n            <v-col align=\"center\">\r\n              <v-btn @click=\"ingresar()\" color=\"primary\" large width=\"200px\" v-if=\"formulario==0\">Ingresar</v-btn>\r\n              <v-btn @click=\"passwordRecovery\" color=\"primary\" width=\"200px\" v-if=\"formulario==1\">Enviar</v-btn>\r\n              <v-btn @click=\"changePassword\" color=\"primary\" width=\"200px\" v-if=\"formulario==2\">Enviar</v-btn>\r\n            </v-col>\r\n          </v-row>\r\n          <v-row>\r\n            <v-col align=\"center\" style=\"padding-bottom:35px\">\r\n              <a href=\"javascript:void(0)\" @click=\"cambiaFormulario(1,'Su email')\" v-if=\"formulario==0\">Olvidaste tu\r\n                contraseña ?</a>\r\n              <a href=\"javascript:void(0)\" @click=\"cambiaFormulario(0, 'Email o Documento Nro')\"\r\n                v-if=\"formulario==1\">Iniciar sesión</a>\r\n            </v-col>\r\n          </v-row>\r\n        </v-card-text>\r\n      </v-card>\r\n    </v-flex>\r\n  </v-layout>\r\n\r\n</template>\r\n<script>\r\nimport { mapActions } from \"vuex\";\r\nimport axios from \"axios\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      usuario: \"\",\r\n      password: \"\",\r\n      error: null,\r\n      valida: 0,\r\n      validaMensaje: [],\r\n      formulario: 0,\r\n      labelMail: \"Usuario\",\r\n      isLoadingLogin: false,\r\n      modulos: [],\r\n      institucion: \"\",\r\n      identificador: \"\",\r\n      personaInstituciones: [],\r\n    };\r\n  },\r\n  computed: {\r\n    usuarioID() {\r\n      return this.$store.state.usuario.idusuario;\r\n    },\r\n    institucionSel() {\r\n      return this.$store.state.usuario.institucion;\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions(\"personas\", [\"limpiarVariablesPersonas\"]),\r\n\r\n    validar() {\r\n      this.limpiarVariablesPersonas();\r\n      this.valida = 0;\r\n      this.validaMensaje = [];\r\n\r\n      if (this.personaInstituciones.length > 1 && !this.identificador) {\r\n        this.validaMensaje.push(\"Debe seleccionar una Institucion\");\r\n      }\r\n\r\n      if (!this.usuario) {\r\n        this.validaMensaje.push(\"El campo Email es Obligatorio\");\r\n      }\r\n      if (!this.password) {\r\n        this.validaMensaje.push(\"El campo Password es Obligatorio.\");\r\n      }\r\n      if (this.validaMensaje.length) {\r\n        this.valida = 1;\r\n      }\r\n      return this.valida;\r\n    },\r\n\r\n    cambiaFormulario(opc, label) {\r\n\r\n      this.formulario = opc;\r\n      this.labelMail = label;\r\n\r\n      this.validaMensaje = [];\r\n\r\n    },\r\n\r\n    ingresar() {\r\n      if (this.validar()) {\r\n        return;\r\n      }\r\n      this.isLoadingLogin = true;\r\n      this.error = null;\r\n      axios\r\n        .post(\"api/Sesion/login\", {\r\n          mail: this.usuario,\r\n          password: this.password,\r\n          identificador: this.identificador,\r\n          deviceID: '',\r\n          deviceUUID: '',\r\n          deviceType: 'web'\r\n        })\r\n        .then(respuesta => {\r\n          return respuesta.data;\r\n        })\r\n        .then(data => {\r\n\r\n          this.$store.dispatch(\"guardarToken\", data.token);\r\n\r\n          this.$store.dispatch(\"cicloLectivo\", new Date().getFullYear());\r\n\r\n          this.$store.dispatch(\"hijoID\", '');\r\n          this.$store.dispatch(\"nombreHijo\", '');\r\n          this.$store.dispatch(\"avatarHijo\", '');\r\n          this.$store.dispatch(\"cursoHijo\", '');\r\n\r\n          if (this.$store.state.usuario.rol == 'Preceptor' || this.$store.state.usuario.rol == 'Alumno' || this.$store.state.usuario.rol == 'Docente' || this.$store.state.usuario.rol == 'Familia') {\r\n            this.$router.push({ name: \"Main\" });\r\n          }\r\n          else {\r\n            this.$router.push({ name: \"home\" });\r\n          }\r\n\r\n        })\r\n        .catch(err => {\r\n          console.log(err.response);\r\n          this.isLoadingLogin = false;\r\n          if (err.response.status == 400) {\r\n            this.error = \"Usuario o contraseña inválidos\";\r\n          } else if (err.response.status == 404) {\r\n            this.error = \"No existe el usuario o sus datos son incorrectos\";\r\n          } else {\r\n            this.error = \"Ocurrió un error\";\r\n          }\r\n\r\n        });\r\n    },\r\n\r\n    listarInstitucionesXPersona() {\r\n      if (this.usuario) {\r\n        this.isLoadingLogin = true;\r\n        this.institucion = \"\";\r\n        this.identificador = \"\";\r\n        if (!this.usuario) { return; }\r\n        let me = this;\r\n        let header = { Authorization: \"Bearer \" + this.$store.state.token };\r\n        let configuracion = { headers: header };\r\n        axios\r\n          .get(\"api/PersonasInstituciones/\" + me.usuario, configuracion)\r\n          .then(function (response) {\r\n            me.personaInstituciones = response.data;\r\n            if (me.personaInstituciones.length == 1) {\r\n              me.institucion = me.personaInstituciones[0].institucion;\r\n              me.identificador = me.personaInstituciones[0].identificador;\r\n\r\n            }\r\n          })\r\n          .catch(function (error) {\r\n            console.log(error);\r\n          });\r\n        this.isLoadingLogin = false;\r\n      }\r\n    },\r\n\r\n    getImgUrl(pic) {\r\n      var n = pic.lastIndexOf(\".\");\r\n      var tipo = pic.substr(n + 1, pic.length - n + 1);\r\n      try {\r\n        return require(\"../Datos/\" + pic);\r\n      } catch (error) {\r\n        console.log(error);\r\n        return require(\"../Datos/images.png\");\r\n      }\r\n    },\r\n\r\n\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.imgLogin {\r\n  width: 60px;\r\n  height: auto;\r\n}\r\n</style>"]}]}