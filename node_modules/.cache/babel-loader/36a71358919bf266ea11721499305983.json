{"remainingRequest":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\babel-loader\\lib\\index.js!C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vuetify-loader\\lib\\loader.js!C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-excel-xlsx\\VueExcelXlsx.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-excel-xlsx\\VueExcelXlsx.vue","mtime":1666176540609},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666176538733},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\babel-loader\\lib\\index.js","mtime":1666176542014},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1666176543703},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1666176538733},{"path":"C:\\DEV\\FLJ\\Plataforma\\PLATTFORM_Sandbox\\node_modules\\vue-loader\\lib\\index.js","mtime":1666176542441}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFhMU1ggZnJvbSAneGxzeC94bHN4JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJ2dWUtZXhjZWwteGxzeCIsCiAgcHJvcHM6IHsKICAgIGNvbHVtbnM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgfSwKICAgIGRhdGE6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgfSwKICAgIGZpbGVOYW1lOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ2V4Y2VsJwogICAgfSwKICAgIHNoZWV0TmFtZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdTaGVldE5hbWUnCiAgICB9LAogICAgZmlsZVR5cGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAneGxzeCcsCiAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gdmFsaWRhdG9yKHZhbCkgewogICAgICAgIHJldHVybiBbJ3hsc3gnLCAneGxzJ10uaW5jbHVkZXModmFsKTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZXhwb3J0RXhjZWw6IGZ1bmN0aW9uIGV4cG9ydEV4Y2VsKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGNyZWF0ZVhMU0xGb3JtYXRPYmogPSBbXTsKICAgICAgdmFyIG5ld1hsc0hlYWRlciA9IFtdOwogICAgICB2YXIgdm0gPSB0aGlzOwoKICAgICAgaWYgKHZtLmNvbHVtbnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY29uc29sZS5sb2coIkFkZCBjb2x1bW5zISIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHZtLmRhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgY29uc29sZS5sb2coIkFkZCBkYXRhISIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdm0uY29sdW1ucy5tYXAoZnVuY3Rpb24gKGNvbHVtbikgewogICAgICAgIG5ld1hsc0hlYWRlci5wdXNoKGNvbHVtbi5sYWJlbCk7CiAgICAgIH0pOwogICAgICBjcmVhdGVYTFNMRm9ybWF0T2JqLnB1c2gobmV3WGxzSGVhZGVyKTsKICAgICAgdm0uZGF0YS5tYXAoZnVuY3Rpb24gKHZhbHVlKSB7CiAgICAgICAgdmFyIGlubmVyUm93RGF0YSA9IFtdOwogICAgICAgIHZtLmNvbHVtbnMubWFwKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgIHZhciBmaWVsZFZhbHVlID0gdmFsdWVbdmFsLmZpZWxkXTsKCiAgICAgICAgICBpZiAodmFsLmZpZWxkLnNwbGl0KCcuJykubGVuZ3RoID4gMSkgewogICAgICAgICAgICBmaWVsZFZhbHVlID0gX3RoaXMuZ2V0TmVzdGVkVmFsdWUodmFsdWUsIHZhbC5maWVsZCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHZhbC5kYXRhRm9ybWF0ICYmIHR5cGVvZiB2YWwuZGF0YUZvcm1hdCA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgICAgICBpbm5lclJvd0RhdGEucHVzaCh2YWwuZGF0YUZvcm1hdChmaWVsZFZhbHVlKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpbm5lclJvd0RhdGEucHVzaChmaWVsZFZhbHVlKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBjcmVhdGVYTFNMRm9ybWF0T2JqLnB1c2goaW5uZXJSb3dEYXRhKTsKICAgICAgfSk7CiAgICAgIHZhciBmaWxlTmFtZSA9IHZtLmZpbGVOYW1lICsgIi4iICsgdm0uZmlsZVR5cGU7CiAgICAgIHZhciB3c19uYW1lID0gdm0uc2hlZXROYW1lOwogICAgICB2YXIgd2IgPSBYTFNYLnV0aWxzLmJvb2tfbmV3KCksCiAgICAgICAgICB3cyA9IFhMU1gudXRpbHMuYW9hX3RvX3NoZWV0KGNyZWF0ZVhMU0xGb3JtYXRPYmopOwogICAgICBYTFNYLnV0aWxzLmJvb2tfYXBwZW5kX3NoZWV0KHdiLCB3cywgd3NfbmFtZSk7CiAgICAgIFhMU1gud3JpdGVGaWxlKHdiLCBmaWxlTmFtZSk7CiAgICB9LAogICAgZ2V0TmVzdGVkVmFsdWU6IGZ1bmN0aW9uIGdldE5lc3RlZFZhbHVlKG9iamVjdCwgc3RyaW5nKSB7CiAgICAgIHN0cmluZyA9IHN0cmluZy5yZXBsYWNlKC9cWyhcdyspXF0vZywgJy4kMScpOwogICAgICBzdHJpbmcgPSBzdHJpbmcucmVwbGFjZSgvXlwuLywgJycpOwogICAgICB2YXIgYSA9IHN0cmluZy5zcGxpdCgnLicpOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIG4gPSBhLmxlbmd0aDsgaSA8IG47ICsraSkgewogICAgICAgIHZhciBrID0gYVtpXTsKCiAgICAgICAgaWYgKGsgaW4gb2JqZWN0KSB7CiAgICAgICAgICBvYmplY3QgPSBvYmplY3Rba107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBvYmplY3Q7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["VueExcelXlsx.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <button @click=\"exportExcel\">\r\n        <slot></slot>\r\n    </button>\r\n</template>\r\n\r\n<script>\r\n    import XLSX from 'xlsx/xlsx';\r\n\r\n    export default {\r\n        name: \"vue-excel-xlsx\",\r\n        props: {\r\n            columns: {\r\n                type: Array,\r\n                default: () => []\r\n            },\r\n            data: {\r\n                type: Array,\r\n                default: () =>  []\r\n            },\r\n            fileName: {\r\n                type: String,\r\n                default: 'excel'\r\n            },\r\n            sheetName: {\r\n                type: String,\r\n                default: 'SheetName'\r\n            },\r\n            fileType: {\r\n                type: String,\r\n                default: 'xlsx',\r\n                validator: (val) => ['xlsx', 'xls'].includes(val)\r\n            }\r\n        },\r\n\r\n        methods: {\r\n            exportExcel() {\r\n                let createXLSLFormatObj = [];\r\n                let newXlsHeader = [];\r\n                let vm = this;\r\n                if (vm.columns.length === 0){\r\n                    console.log(\"Add columns!\");\r\n                    return;\r\n                }\r\n                if (vm.data.length === 0){\r\n                    console.log(\"Add data!\");\r\n                    return;\r\n                }\r\n                vm.columns.map(column => {\r\n                    newXlsHeader.push(column.label);\r\n                });\r\n\r\n                createXLSLFormatObj.push(newXlsHeader);\r\n                vm.data.map(value => {\r\n                    let innerRowData = [];\r\n                    vm.columns.map(val => {\r\n                      let fieldValue = value[val.field];\r\n                      if (val.field.split('.').length > 1) {\r\n                        fieldValue = this.getNestedValue(value, val.field);\r\n                      }\r\n                      if (val.dataFormat && typeof val.dataFormat === 'function') {\r\n                            innerRowData.push(val.dataFormat(fieldValue));\r\n                        } else {\r\n                            innerRowData.push(fieldValue);\r\n                        }\r\n                    });\r\n                    createXLSLFormatObj.push(innerRowData);\r\n                });\r\n\r\n                let fileName = vm.fileName + \".\" + vm.fileType;\r\n\r\n                let ws_name = vm.sheetName;\r\n\r\n                let wb = XLSX.utils.book_new(),\r\n                    ws = XLSX.utils.aoa_to_sheet(createXLSLFormatObj);\r\n                XLSX.utils.book_append_sheet(wb, ws, ws_name);\r\n                XLSX.writeFile(wb, fileName);\r\n            },\r\n            getNestedValue(object, string) {\r\n                string = string.replace(/\\[(\\w+)\\]/g, '.$1');\r\n                string = string.replace(/^\\./, '');\r\n                let a = string.split('.');\r\n                for (let i = 0, n = a.length; i < n; ++i) {\r\n                  let k = a[i];\r\n                  if (k in object) {\r\n                    object = object[k];\r\n                  } else {\r\n                    return;\r\n                  }\r\n                }\r\n                return object;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n"],"sourceRoot":"node_modules/vue-excel-xlsx"}]}